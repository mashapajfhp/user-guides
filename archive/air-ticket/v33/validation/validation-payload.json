{
  "instructions": {
    "payload_format": "reference-based-v2",
    "description": "This payload uses ID references to avoid data duplication. You MUST resolve references before executing tests.",
    "reference_resolution": {
      "access_path_ref": {
        "description": "Reference to a navigation path",
        "lookup": "Find in definitions.access_paths.configuration OR definitions.access_paths.operational where path_id matches",
        "returns": "Navigation steps array, canonical_path for Supabase lookup, and path details"
      },
      "setup_flow_ref": {
        "description": "Reference to a setup/configuration flow",
        "lookup": "Find in definitions.setup_flows where flow_id matches",
        "returns": "Array of steps to execute in order"
      },
      "business_rule_refs": {
        "description": "Array of business rule IDs to validate",
        "lookup": "Find each in definitions.business_rules where rule_id matches",
        "returns": "Rule description and expected UI manifestation"
      },
      "edge_case_refs": {
        "description": "Array of edge case IDs to check",
        "lookup": "Find each in definitions.edge_cases where case_id matches",
        "returns": "Scenario description and expected UI behavior"
      },
      "ui_element_refs": {
        "description": "Array of UI element names relevant to test",
        "lookup": "Find each in definitions.ui_elements where element_name matches",
        "returns": "Element type and location"
      }
    },
    "navigation_taxonomy": {
      "description": "Use canonical_path with Supabase resolve_navigation_path() for reliable navigation",
      "usage": "curl -s \"${SUPABASE_URL}/rest/v1/rpc/resolve_navigation_path\" -H \"apikey: ${SUPABASE_ANON_KEY}\" -H \"Authorization: Bearer ${SUPABASE_ANON_KEY}\" -H \"Content-Type: application/json\" -d '{\"p_canonical_path\": \"<canonical_path>\", \"p_env\": \"prod\"}'",
      "returns": "nav_steps array with labels and levels for menu clicks"
    },
    "execution_workflow": [
      "1. Read the test from tests array",
      "2. Resolve access_path_ref → get canonical_path",
      "3. Query Supabase resolve_navigation_path(canonical_path) → get nav_steps",
      "4. Resolve setup_flow_ref → get setup steps",
      "5. Execute nav_steps using Playwright (click each menu item in order)",
      "6. Execute setup steps using Playwright",
      "7. Perform test validations from assertions",
      "8. Check resolved business_rules are satisfied",
      "9. Verify resolved edge_cases behave as expected",
      "10. Capture screenshots as evidence",
      "11. Record pass/fail result"
    ],
    "example": {
      "test_with_refs": {
        "test_id": "TEST-EXAMPLE-001",
        "setup_flow_ref": "SETUP-001",
        "business_rule_refs": [
          "BR-001",
          "BR-002"
        ]
      },
      "resolution_steps": [
        "1. Look up SETUP-001 in definitions.setup_flows",
        "2. Find the flow object with matching flow_id",
        "3. Execute each step in the steps array in order",
        "4. Look up BR-001 and BR-002 in definitions.business_rules",
        "5. Validate that the UI behaves according to those rules"
      ]
    }
  },
  "metadata": {
    "feature_name": "Air Ticket",
    "feature_slug": "air-ticket",
    "version": "v33",
    "folder_path": "air-ticket/v33",
    "readme_path": "air-ticket/v33/README.md",
    "github_root_path": "air-ticket/",
    "generated_at": "2026-01-09T09:43:32.160Z",
    "source": "jira+zendesk",
    "payload_format": "reference-based-v2",
    "zendesk_status": {
      "available": true
    }
  },
  "summary": {
    "total_tests": 4,
    "by_priority": {
      "must_test": 2,
      "should_test": 2,
      "nice_to_test": 0
    },
    "by_test_type": {
      "workflow": 2,
      "ui_visibility": 1,
      "text_verification": 1,
      "form_interaction": 0,
      "permission_check": 0
    },
    "documentation_candidates": 6,
    "excluded": 2,
    "zendesk_data_available": true
  },
  "definitions": {
    "access_paths": {
      "configuration": [
        {
          "path_id": "CFG-001",
          "path_name": "Create Air Ticket Allowance Policy",
          "navigation": [
            "Settings",
            "Company",
            "Air ticket policies",
            "Add New"
          ],
          "canonical_path": "Settings > Company > Air ticket policies > Add New",
          "source_article": "Setting up an air ticket allowance policy"
        },
        {
          "path_id": "CFG-002",
          "path_name": "Configure Air Ticket Auto Encashment Workflow",
          "navigation": [
            "Settings",
            "Workflows",
            "Create New",
            "Air Tickets Auto Encashment Recipe"
          ],
          "canonical_path": "Settings > Workflows > Create New > Air Tickets Auto Encashment Recipe",
          "source_article": "Air Tickets Auto Encashments via Workflows"
        }
      ],
      "operational": []
    },
    "setup_flows": [
      {
        "flow_id": "SETUP-001",
        "flow_name": "Create Air Ticket Allowance Policy",
        "steps": [
          {
            "step": 1,
            "action": "Navigate to Settings > Company > Air ticket policies",
            "element_type": "navigation",
            "expected_result": "Air ticket policies page loads"
          },
          {
            "step": 2,
            "action": "Click Add New button",
            "element_type": "button",
            "expected_result": "Policy creation form opens"
          },
          {
            "step": 3,
            "action": "Enter policy name",
            "element_type": "input",
            "expected_result": "Policy name is saved"
          },
          {
            "step": 4,
            "action": "Define allowance amount",
            "element_type": "input",
            "expected_result": "Allowance amount is recorded"
          },
          {
            "step": 5,
            "action": "Select redeem options (Reimbursement, Encashment, Ticket Booking)",
            "element_type": "checkbox",
            "expected_result": "Selected options are marked"
          },
          {
            "step": 6,
            "action": "Select eligible employees",
            "element_type": "table",
            "expected_result": "Employees are assigned to policy"
          },
          {
            "step": 7,
            "action": "Review and finalize policy",
            "element_type": "button",
            "expected_result": "Policy is created and activated"
          }
        ],
        "source_article": "Setting up an air ticket allowance policy"
      },
      {
        "flow_id": "SETUP-002",
        "flow_name": "Configure Air Ticket Auto Encashment Workflow",
        "steps": [
          {
            "step": 1,
            "action": "Navigate to Settings > Workflows",
            "element_type": "navigation",
            "expected_result": "Workflows page loads"
          },
          {
            "step": 2,
            "action": "Select Air Tickets Auto Encashment recipe",
            "element_type": "button",
            "expected_result": "Workflow configuration form opens"
          },
          {
            "step": 3,
            "action": "Set trigger date and time",
            "element_type": "date_picker",
            "expected_result": "Date and hour are configured"
          },
          {
            "step": 4,
            "action": "Select encashment criteria",
            "element_type": "dropdown",
            "expected_result": "Encashment options are selected"
          },
          {
            "step": 5,
            "action": "Assign employee and select request type",
            "element_type": "dropdown",
            "expected_result": "Employee and request type are assigned"
          },
          {
            "step": 6,
            "action": "Save and activate workflow",
            "element_type": "button",
            "expected_result": "Workflow is activated and ready"
          }
        ],
        "source_article": "Air Tickets Auto Encashments via Workflows"
      }
    ],
    "business_rules": [
      {
        "rule_id": "BR-002",
        "rule": "Employees cannot be assigned to multiple air ticket policies",
        "ui_manifestation": "System prevents assigning same employee to multiple policies; dropdown shows only unassigned employees",
        "source_article": "Setting up an air ticket allowance policy"
      },
      {
        "rule_id": "BR-004",
        "rule": "Active policies cannot be edited once ticket requests are raised",
        "ui_manifestation": "Edit button disabled or grayed out for policies with pending/approved requests",
        "source_article": "Setting up an air ticket allowance policy"
      },
      {
        "rule_id": "BR-005",
        "rule": "Allowance amount applies collectively to listed dependents, not individually",
        "ui_manifestation": "Single allowance field shown per policy; dependent selection does not multiply allowance",
        "source_article": "Setting up an air ticket allowance policy"
      },
      {
        "rule_id": "BR-006",
        "rule": "Workflow time configuration is based on UAE or KSA account location",
        "ui_manifestation": "Time selector displays timezone based on account location setting",
        "source_article": "Air Tickets Auto Encashments via Workflows"
      },
      {
        "rule_id": "BR-007",
        "rule": "Allowance can vary by employee seniority or country/region",
        "ui_manifestation": "Policy creation allows multiple allowance tiers based on employee attributes",
        "source_article": "Air ticket request"
      }
    ],
    "edge_cases": [
      {
        "case_id": "EC-002",
        "scenario": "Admin attempts to edit active policy with existing ticket requests",
        "expected_ui_behavior": "Edit action prevented; warning message displayed explaining policy is locked",
        "source_article": "Setting up an air ticket allowance policy"
      },
      {
        "case_id": "EC-004",
        "scenario": "Workflow minute selector is used for auto encashment trigger",
        "expected_ui_behavior": "Minute field is non-functional; only hour selection is applied",
        "source_article": "Air Tickets Auto Encashments via Workflows"
      },
      {
        "case_id": "EC-005",
        "scenario": "Admin creates multiple policies for different hierarchy levels",
        "expected_ui_behavior": "System allows multiple policies; each employee assigned to only one based on seniority",
        "source_article": "Air ticket request"
      },
      {
        "case_id": "EC-006",
        "scenario": "Workflow configured without selecting an assignee employee",
        "expected_ui_behavior": "Save button disabled; error message requires assignee selection",
        "source_article": "Air Tickets Auto Encashments via Workflows"
      }
    ],
    "ui_elements": [
      {
        "element_name": "Add New Policy button",
        "element_type": "button",
        "location": "Settings > Company > Air ticket policies"
      },
      {
        "element_name": "Policy Name input field",
        "element_type": "input",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Allowance Amount input field",
        "element_type": "input",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Redeem Options checkboxes",
        "element_type": "checkbox",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Eligible Employees table",
        "element_type": "table",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Workflows menu",
        "element_type": "navigation",
        "location": "Settings > Workflows"
      },
      {
        "element_name": "Air Tickets Auto Encashment Recipe selector",
        "element_type": "button",
        "location": "Settings > Workflows > Create New"
      },
      {
        "element_name": "Trigger Date picker",
        "element_type": "date_picker",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Trigger Time selector (hour only)",
        "element_type": "dropdown",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Encashment Criteria dropdown",
        "element_type": "dropdown",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Request Type dropdown",
        "element_type": "dropdown",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Assignee Employee dropdown",
        "element_type": "dropdown",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Save Workflow button",
        "element_type": "button",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Workflow Activity Log",
        "element_type": "table",
        "location": "Settings > Workflows > Air Tickets Auto Encashment"
      },
      {
        "element_name": "Request Timing dropdown",
        "element_type": "dropdown",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Renewal Cycle dropdown",
        "element_type": "dropdown",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Request Limits input field",
        "element_type": "input",
        "location": "Settings > Company > Air ticket policies > Create"
      },
      {
        "element_name": "Review and Finalize button",
        "element_type": "button",
        "location": "Settings > Company > Air ticket policies > Create"
      }
    ]
  },
  "tests": [
    {
      "test_id": "TEST-AV-6477",
      "ticket_key": "AV-6477",
      "test_name": "FE: Show remaining air tickets when balance is on hold due to booking request",
      "validation_priority": "should_test",
      "test_type": "ui_visibility",
      "theme": "Air ticket balance visibility",
      "description": "validate implementation",
      "what_to_test": "Employee Benefits > Air Tickets: Verify remaining ticket balance displays correctly when a booking request is pending or on-hold status",
      "access_path_ref": "CFG-002",
      "setup_flow_ref": "SETUP-002",
      "business_rule_refs": [
        "BR-004",
        "BR-002"
      ],
      "edge_case_refs": [
        "EC-002"
      ],
      "ui_element_refs": [
        "Request Type dropdown",
        "Request Timing dropdown",
        "Request Limits input field",
        "Assignee Employee dropdown",
        "Air Tickets Auto Encashment Recipe selector",
        "Trigger Date picker",
        "Trigger Time selector (hour only)",
        "Encashment Criteria dropdown",
        "Save Workflow button",
        "Workflow Activity Log"
      ],
      "assertions": [
        "Assert remaining air ticket balance is visible on the air tickets card",
        "Assert balance updates correctly when booking request is in pending state",
        "Assert balance display does not show zero when tickets are reserved by pending request",
        "Assert balance reflects actual available tickets minus those on hold"
      ],
      "source": {
        "ticket_key": "AV-6477",
        "status": "Already Done",
        "issue_type": "Bug"
      }
    },
    {
      "test_id": "TEST-AV-6343",
      "ticket_key": "AV-6343",
      "test_name": "FE: Unclear indication of available air ticket requests",
      "validation_priority": "should_test",
      "test_type": "text_verification",
      "theme": "Air ticket request counter clarity",
      "description": "validate implementation",
      "what_to_test": "Employee Benefits > Air Tickets: Verify the air ticket request counter displays clear, unambiguous text indicating available vs. used requests",
      "access_path_ref": "CFG-002",
      "setup_flow_ref": "SETUP-002",
      "business_rule_refs": [
        "BR-004",
        "BR-002",
        "BR-006"
      ],
      "edge_case_refs": [
        "EC-002"
      ],
      "ui_element_refs": [
        "Request Timing dropdown",
        "Request Limits input field",
        "Request Type dropdown",
        "Eligible Employees table",
        "Assignee Employee dropdown",
        "Add New Policy button",
        "Policy Name input field",
        "Allowance Amount input field",
        "Redeem Options checkboxes",
        "Renewal Cycle dropdown"
      ],
      "assertions": [
        "Assert request counter label clearly indicates available requests remaining",
        "Assert zero available requests displays with explicit 'Available: 0' or similar text",
        "Assert notation does not use ambiguous formats like '0/1'",
        "Assert label text matches redesigned info card implementation"
      ],
      "source": {
        "ticket_key": "AV-6343",
        "status": "Already Done",
        "issue_type": "Bug"
      }
    },
    {
      "test_id": "TEST-TSSD-3193",
      "ticket_key": "TSSD-3193",
      "test_name": "Client is unable to remove Processed Air tickets",
      "validation_priority": "must_test",
      "test_type": "workflow",
      "theme": "Processed air ticket removal workflow",
      "description": "verify fix works",
      "what_to_test": "Work Expenses > Air Tickets: Verify processed air ticket requests can be rejected after reopening the payroll month and rejecting the associated payroll transaction",
      "access_path_ref": "CFG-002",
      "setup_flow_ref": "SETUP-002",
      "business_rule_refs": [
        "BR-002",
        "BR-004"
      ],
      "edge_case_refs": [
        "EC-002"
      ],
      "ui_element_refs": [
        "Request Type dropdown",
        "Workflow Activity Log",
        "Air Tickets Auto Encashment Recipe selector",
        "Trigger Date picker",
        "Trigger Time selector (hour only)",
        "Encashment Criteria dropdown",
        "Assignee Employee dropdown",
        "Save Workflow button",
        "Request Timing dropdown",
        "Request Limits input field"
      ],
      "assertions": [
        "Assert reject/delete options are disabled for processed air tickets when payroll month is closed",
        "Assert reject/delete options become enabled after reopening the payroll month",
        "Assert reject/delete options become enabled after rejecting the associated payroll transaction",
        "Assert air ticket request status changes to rejected after completing the workflow",
        "Assert rejected air ticket no longer appears in processed list"
      ],
      "source": {
        "ticket_key": "TSSD-3193",
        "status": "Resolved",
        "issue_type": "Bug"
      }
    },
    {
      "test_id": "TEST-TSSD-3366",
      "ticket_key": "TSSD-3366",
      "test_name": "Need to remove processed (Encashment) Air tickets with Payroll reopen",
      "validation_priority": "must_test",
      "test_type": "workflow",
      "theme": "Cross-period air ticket encashment transfer",
      "description": "verify fix works",
      "what_to_test": "Payroll Management > Air Ticket Encashment: Verify processed air ticket encashment transactions can be moved between payroll periods by reopening the source month, deleting the transaction, and moving the request to pending status",
      "access_path_ref": "CFG-002",
      "setup_flow_ref": "SETUP-002",
      "business_rule_refs": [
        "BR-004",
        "BR-002"
      ],
      "edge_case_refs": [
        "EC-002",
        "EC-004"
      ],
      "ui_element_refs": [
        "Encashment Criteria dropdown",
        "Request Type dropdown",
        "Workflow Activity Log",
        "Air Tickets Auto Encashment Recipe selector",
        "Trigger Date picker",
        "Trigger Time selector (hour only)",
        "Assignee Employee dropdown",
        "Save Workflow button",
        "Request Timing dropdown",
        "Request Limits input field"
      ],
      "assertions": [
        "Assert processed air ticket encashment appears in closed payroll month",
        "Assert payroll month can be reopened to unlock processed transactions",
        "Assert processed transaction can be deleted after payroll month is reopened",
        "Assert air ticket request returns to pending status after transaction deletion",
        "Assert pending air ticket request can be reassigned to a different payroll period"
      ],
      "source": {
        "ticket_key": "TSSD-3366",
        "status": "Resolved",
        "issue_type": "Support"
      }
    }
  ],
  "limitations": {
    "documentation_candidates": [
      {
        "ticket_key": "TSSD-2933",
        "summary": "Air ticket carry over",
        "documentation_type": "configuration_note",
        "limitation_statement": "Air ticket policies do not support indefinite carry-over of unused balances between renewal cycles. Unused ticket allowances expire at the end of each policy renewal period.",
        "user_impact": "Organizations must carefully calculate total requests across multi-year cycles (e.g., 5 requests per year × 5 years = 25 total requests) rather than relying on automatic carry-over.",
        "workaround": "Set total number of requests to the product of annual requests and renewal cycle duration (e.g., 5 × 5 = 25 for a 5-year cycle with 5 annual requests)",
        "guide_section": "Air Ticket Policy Configuration > Renewal Cycles and Request Allocation"
      },
      {
        "ticket_key": "TSSD-3954",
        "summary": "Air tickets - Booked tickets notification (tagging LM when not in approval flow OR workflow on ticket requests)",
        "documentation_type": "feature_gap",
        "limitation_statement": "The platform cannot notify or tag line managers about air ticket processing when they are outside the formal approval workflow. There is no automated notification system for proxy requesters who submit requests on behalf of employees.",
        "user_impact": "Line managers who submit air ticket requests on behalf of employees cannot track completion status or receive automated notifications, requiring manual follow-up.",
        "workaround": "Include line managers in the approval flow to enable notifications, or configure workflow rules if air ticket application becomes available in Workflows module",
        "guide_section": "Air Ticket Requests > Notifications and Tracking for Proxy Requesters"
      },
      {
        "ticket_key": "OS-695",
        "summary": "As an employee I want to manage my air ticket requests from my air tickets",
        "documentation_type": "business_decision",
        "limitation_statement": "The platform does not provide a unified interface for employees to manage air ticket requests across different policy states (inactive policies, missing hire/probation dates, ineligibility conditions).",
        "user_impact": "Employees cannot view or manage air ticket requests when auto-encashment policies are inactive or when they lack required employee record data.",
        "workaround": "Ensure hire date and probation end date are populated in employee records before assigning auto-encashment policies",
        "guide_section": "Air Ticket Management > Policy States and Eligibility Requirements"
      },
      {
        "ticket_key": "TSSD-1995",
        "summary": "Expense Manager access to Loans",
        "documentation_type": "feature_gap",
        "limitation_statement": "The Expense Manager role has broad visibility across multiple financial modules (loans, air tickets, work expenses) without granular permission controls to restrict access to specific data categories.",
        "user_impact": "Organizations cannot restrict Expense Managers to view only work expenses, creating potential data privacy and security concerns.",
        "workaround": "Use employee grouping and structures (when available) to segment financial data access by department or cost center",
        "guide_section": "Role Permissions > Expense Manager Visibility Scope"
      },
      {
        "ticket_key": "TSSD-2511",
        "summary": "Letter requests - upload the document after stamping",
        "documentation_type": "feature_gap",
        "limitation_statement": "The platform does not support external document signing workflows for letter requests. Approved letter requests cannot be modified, returned to pending status, or have attachments added after approval.",
        "user_impact": "Organizations requiring physical document stamping or external attestation must use email-based workarounds instead of managing signed documents within the platform.",
        "workaround": "Share letter requests via email for external signing, then manually attach signed documents to employee records outside the request workflow",
        "guide_section": "Letter Requests > External Signing and Attestation Workflows"
      },
      {
        "ticket_key": "TSSD-4672",
        "summary": "Restricted People manager role - can still see other employees (out of assigned group)",
        "documentation_type": "feature_gap",
        "limitation_statement": "Employee group restrictions are inconsistently applied across platform modules. People Manager and Adjustment Manager roles can view and edit employees outside their assigned groups in HR and document modules, even when grouping is enabled.",
        "user_impact": "Organizations cannot fully implement department-level access controls for People Managers and Adjustment Managers across all modules, creating data privacy and organizational control gaps.",
        "workaround": "Use employee grouping for finance and payroll modules only; implement separate access controls for HR modules through other means",
        "guide_section": "Employee Groups and Role Restrictions > Module Coverage and Limitations"
      }
    ],
    "excluded": [
      {
        "ticket_key": "TSSD-4272",
        "summary": "Limited access for employees to view other users",
        "blocker": "feature_roadmap_pending",
        "reason": "Feature is on product roadmap (Employee Grouping and Structures) with no committed timeline. Partially available on-demand for some modules but not yet generally available for HR modules."
      },
      {
        "ticket_key": "TSSD-1403",
        "summary": "Need to delete the test air tickets processed",
        "blocker": "backend_calculation",
        "reason": "Ticket describes a permanent system limitation (processed air tickets cannot be deleted) that is not UI-testable and provides no meaningful user guidance beyond 'avoid processing test data'."
      }
    ]
  },
  "source_articles": [
    {
      "article_id": 13937889131409,
      "title": "How to request Air ticket"
    },
    {
      "article_id": 13937322643857,
      "title": "Setting up an air ticket allowance policy"
    },
    {
      "article_id": 31099964679057,
      "title": "Air Tickets Auto Encashments via Workflows"
    },
    {
      "article_id": 23328000633489,
      "title": "Air ticket request"
    }
  ]
}