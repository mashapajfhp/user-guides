import{jR as U,kh as ie,iY as T,a5 as N,O as h,Q as O,b1 as oe,b2 as C,bl as se,b3 as re,bm as B,dy as le,m8 as ce,dA as me,H as Y,a as Q,c2 as G,bN as W,r,j as a,S as pe,bb as de,T as b,d as H,af as $,d4 as ue,bU as ge,W as fe,b9 as he,aK as xe,a8 as Me,jh as ye,aN as A,aj as _e,ak as be,cY as Ie,bS as ve,d9 as Ae,C as Ce,fX as ke,L as S,ab as De}from"./assets/index-rhBbSAok.js";import{d as Ee}from"./GenericSuccessResponse-R235NyAN__cache.js";import{s as je}from"./FileRequestPayload-1y2BXBNm__cache.js";import{d as Fe}from"./LoanRequestFileResponsePayload-OeNTn5aF__cache.js";import{m as Le}from"./mapResponseArrayGenerator-jtAzkRDY__cache.js";import{I as z}from"./ButtonWithTooltip-ZRvEDUuf__cache.js";import{C as Te}from"./ConfigurationAccordionTitle-qLBxSX7i__cache.js";import{C as Ne}from"./ConfigurationAccordion-sH02smW7__cache.js";import{S as $e}from"./ScrollTarget-WuHGBBQV__cache.js";import{P as Se}from"./Pencil1Icon-g4OBhpYF__cache.js";import{A as ze}from"./ActionsCellLayout-QoNJZX4W__cache.js";var Ue=(e=>(e.Percentage="Percentage",e.Amount="Amount",e))(Ue||{});const K=[["Percentage",{id:"percentage",name:"Percentage"}],["Amount",{id:"amount",name:"Amount"}]],Oe=new Map(K),Be=new Map(K.map(([e,t])=>[t.id,e]));function Ye(e){return Oe.get(e).id}function Qe(e){return Be.get(e)}var Ge=(e=>(e.Static="Static",e.Flexible="Flexible",e))(Ge||{});const X=[["Static",{id:"static",name:"Static"}],["Flexible",{id:"flexible",name:"Flexible"}]],We=new Map(X),He=new Map(X.map(([e,t])=>[t.id,e]));function Ke(e){return We.get(e).id}function Xe(e){return He.get(e)}function Je(e){const t={};return t.active=e.active,t.creationDate=e.creation_date,t.currency=U(e.currency),t.hasAnyRequest=e.has_any_request,t.id=e.id,t.name=e.name,t.numberOfEmployees=e.number_of_employees,t}function J(e){const t={};return t.active=e.active,e.agreementFile&&(t.agreement_file=je(e.agreementFile)),t.currency=ie(e.currency),t.description=e.description,t.differ_first_repayment_from_initial_cycle=e.differFirstRepaymentFromInitialCycle,t.disallow_request_in_probation=e.disallowRequestInProbation,t.employee_ids=e.employeeIds,t.loan_amount_type=Ye(e.loanAmountType),t.loan_installment_type=Ke(e.loanInstallmentType),t.max_installment_percentage=e.maxInstallmentPercentage,t.max_installments=e.maxInstallments,e.maxLoanAmount&&(t.max_loan_amount=T(e.maxLoanAmount)),t.max_loan_percentage=e.maxLoanPercentage,t.min_installments=e.minInstallments,e.minLoanAmount&&(t.min_loan_amount=T(e.minLoanAmount)),t.name=e.name,t}function V(e){const t={};return t.active=e.active,e.agreement_file&&(t.agreementFile=Fe(e.agreement_file)),t.creationDate=e.creation_date,t.currency=U(e.currency),t.description=e.description,t.differFirstRepaymentFromInitialCycle=e.differ_first_repayment_from_initial_cycle,t.disallowRequestInProbation=e.disallow_request_in_probation,t.hasAnyRequest=e.has_any_request,t.id=e.id,t.loanAmountType=Qe(e.loan_amount_type),t.loanInstallmentType=Xe(e.loan_installment_type),t.maxInstallmentPercentage=e.max_installment_percentage,t.maxInstallments=e.max_installments,e.max_loan_amount&&(t.maxLoanAmount=N(e.max_loan_amount)),t.maxLoanPercentage=e.max_loan_percentage,t.minInstallments=e.min_installments,e.min_loan_amount&&(t.minLoanAmount=N(e.min_loan_amount)),t.name=e.name,t.numberOfEmployees=e.number_of_employees,t}const x=({companyId:e,policyId:t})=>t?`/companies/${e}/loan/policies/${t}`:`/companies/${e}/loan/policies`,Z=e=>{const t=Ve.useMocker();return O({toURLFunction:x,mapResponseFunction:Le(Je),options:{mocker:t}})(e)},Ve=h(Z),Ze=()=>{const e=we.useMocker();return oe({toURLFunction:x,mapRequestFunction:B(J),mapResponseFunction:C(V),options:{mocker:e}})},we=h(Ze),Pe=(e,t)=>{const i=qe.useMocker();return O({toURLFunction:x,mapResponseFunction:C(V),options:{mocker:i}})(e,void 0,t)},qe=h(Pe),Re=()=>{const e=et.useMocker();return se({toURLFunction:x,mapRequestFunction:B(J),mapResponseFunction:C(Ee),options:{mocker:e}})},et=h(Re),w=()=>{const e=tt.useMocker();return re({toURLFunction:x,options:{mocker:e}})},tt=h(w),at=le("/companies/{companyId}/loan/policies/{policyId}/activate","put",{apiUrlPrefix:ce});function P(e={}){const t=at(P);return me({mutationFn:t,...e})}const nt=Y()(e=>({dialogTitle:{display:"flex",alignItems:"center"},mediumRightMargin:{marginRight:e.spacing(2),width:42,height:42}})),it=({selectedItemId:e,selectedItemName:t,isLoading:i,onClose:g,onSubmit:l})=>{const{classes:c}=nt(),o=Q(),m=G(),{handleRequestExceptionAlert:d}=W(),u=r.useCallback(async()=>{try{await l(e),m.success({message:o.formatMessage(_.deleteItem)})}catch(f){d(f,{fallbackMessage:o.formatMessage(_.cannotDeleteItem)})}},[l,e,m,o,d]);return a.jsx(pe,{open:!0,maxWidth:"sm",fullWidth:!0,title:a.jsxs("div",{className:c.dialogTitle,children:[a.jsx(de,{color:"error",fontSize:"small",className:c.mediumRightMargin}),a.jsx(b,{variant:"h4",children:o.formatMessage(_.deleteTitle)})]}),content:a.jsx(b,{variant:"body1",children:o.formatMessage(_.deleteQuestion,{itemName:t,strong:f=>a.jsx("strong",{children:f})})}),isPending:i,confirmButton:{color:"error",text:o.formatMessage({id:"common.action.delete",defaultMessage:"Delete"}),onClick:u},cancelButton:{show:!0,color:"error",onClick:g},showCloseButton:!0,onClose:g})},_=H({deleteQuestion:{id:"hr.app.page.configuration.settings-list-item.delete-question",defaultMessage:"Are you sure you want to delete <strong>{itemName}</strong>?"},deleteItem:{id:"hr.settings.payroll.delete-item",defaultMessage:"Item has been deleted."},cannotDeleteItem:{id:"hr.settings.payroll.cannot-delete-item",defaultMessage:"Unable to delete item. Please try again."},deleteTitle:{id:"hr.app.page.configuration.settings-list-item.delete-title",defaultMessage:"Confirm deletion"}});function ot(){var l,c,o,m;const{state:e}=ue(),t=(c=(l=e.bootstrapData)==null?void 0:l.company)==null?void 0:c.id,i=(m=(o=e.bootstrapData)==null?void 0:o.company)==null?void 0:m.name;return r.useCallback(({event:d,...u})=>{t&&i&&ge({event:`payroll.loan-requests.${d}`,companyId:t,companyName:i,...u})},[t,i])}const st=Y()(e=>({centerElements:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:e.spacing(4),marginLeft:e.spacing(2),border:`1px solid ${$.grey[200]}`,borderRadius:4},childrenContainer:{display:"flex",flexDirection:"column",flexGrow:1},footerContainer:{display:"flex"},navigationButton:{alignSelf:"flex-start",marginTop:e.spacing(2)},activeColor:{color:e.palette.success.dark},inactiveColor:{color:$.grey[300]}})),Mt=()=>{const{classes:e}=st(),t=Q(),i=fe(),g=he(),{hash:l}=xe(),c=G(),{handleRequestExceptionAlert:o}=W(),m=Me(ye),d=ot(),[u,f]=r.useState(),[q,I]=r.useState(!1),{data:M,isPending:R,refetch:y}=Z({companyId:i}),{mutateAsync:k,isPending:D}=w(),{mutateAsync:E,isPending:ee}=P(),j=r.useMemo(()=>(M==null?void 0:M.data)??[],[M]),F=r.useCallback(async(s,n)=>{try{await E({companyId:i,policyId:n,active:s}),c.success({message:t.formatMessage(p.updateItem)})}catch(v){o(v,{fallbackMessage:t.formatMessage(p.cannotUpdateItem)})}finally{await y()}},[E,i,c,t,o,y]),L=r.useCallback(s=>{g.pushToApp(A.APP_PAYROLL,`/loan-policy/edit/${s}`)},[g]),te=s=>{f(s),I(!0)},ae=r.useCallback(async s=>{try{return await k({urlParams:{companyId:i,policyId:s}})}finally{await y(),I(!1)}},[i,y,k]),ne=r.useMemo(()=>[{title:t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.policy-name",defaultMessage:"Policy Name"}),dataExternalId:"name",dataIndex:"name",align:"left",proportion:1},{title:t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.number-of-employees",defaultMessage:"No. of Employees"}),dataExternalId:"numberOfEmployees",dataIndex:"numberOfEmployees",align:"left",proportion:1},{title:t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.creation-date",defaultMessage:"Creation Date"}),dataExternalId:"creationDate",dataIndex:"creationDate",align:"left",proportion:1,accessor:(s,n)=>_e(new Date(n.creationDate),be.DATE_FIELD)},{title:t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.currency",defaultMessage:"Currency"}),dataExternalId:"currency",dataIndex:"currency",align:"left",proportion:1,accessor:(s,n)=>m(n.currency)},{title:"",dataExternalId:"actions",dataIndex:"id",align:"right",proportion:1,cellPadding:"horizontal",accessor:(s,n)=>a.jsxs(ze,{children:[a.jsx(Ie,{"data-external-id":"employee-loan-policies-active-toggle",text:a.jsx(b,{variant:"h6",className:n.active?e.activeColor:e.inactiveColor,children:n.active?t.formatMessage({id:"common.active",defaultMessage:"Active"}):t.formatMessage({id:"common.inactive",defaultMessage:"Inactive"})}),checked:n.active,onChange:v=>F(v,n.id)}),a.jsx(z,{title:n.hasAnyRequest?t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.edit-reason",defaultMessage:"You can only edit this policy's employee list because there are loans requested under the policy."}):t.formatMessage({id:"common.action.edit",defaultMessage:"Edit"}),"data-external-id":"edit-button",onClick:()=>L(n.id),size:"small",color:"primary",children:a.jsx(Se,{})}),a.jsx(z,{title:n.hasAnyRequest?t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.table.delete-reason",defaultMessage:"You can not delete this policy because there are loans requested under the policy."}):t.formatMessage({id:"common.action.delete",defaultMessage:"Delete"}),"data-external-id":"delete-button",onClick:()=>te(n),disabled:n.hasAnyRequest,size:"small",color:"primary",children:a.jsx(ve,{})})]})}],[t,F,L,m,e]);return a.jsxs($e,{scroll:l==="#loan-policies",children:[a.jsx(Ne,{id:"loan-policies","data-external-id":"employee-loan-policies",expandedByDefault:l==="#loan-policies",title:a.jsx(Te,{"data-external-id":"header",title:t.formatMessage(p.header),subtitle:t.formatMessage(p.description)}),children:j.length?a.jsxs("div",{className:e.childrenContainer,children:[a.jsx(Ae,{open:R||ee||D,children:a.jsx(Ce,{color:"inherit"})}),a.jsx(ke,{columns:ne,data:j??[],variant:"outlined",emptyState:t.formatMessage(p.noItemsYet)}),a.jsx("div",{className:e.footerContainer,children:a.jsx(S,{className:e.navigationButton,app:A.APP_PAYROLL,to:"/loan-policy/new",variant:"contained",color:"primary","data-external-id":"configure-loan-policy-button",onClick:()=>{d({event:"new-loan-policy.click"})},children:t.formatMessage(p.createNewLoanPolicy)})})]}):a.jsxs("div",{className:e.centerElements,children:[a.jsx(De,{title:t.formatMessage({id:"hr.app.page.configuration.payroll.employee-loan-policies.no-policies",defaultMessage:"No policies found"}),subtitle:a.jsx(b,{variant:"body1",color:"textSecondary",component:"span",children:t.formatMessage(p.noPoliciesDescription)})}),a.jsx(S,{app:A.APP_PAYROLL,to:"/loan-policy/new",variant:"contained",color:"primary","data-external-id":"configure-loan-policy-button",onClick:()=>{d({event:"new-loan-policy.click"})},children:t.formatMessage(p.createNewLoanPolicy)})]})}),u&&q&&a.jsx(it,{selectedItemId:u.id,selectedItemName:u.name,isLoading:D,onSubmit:ae,onClose:()=>I(!1)})]})},p=H({updateItem:{id:"hr.settings.company.update-item",defaultMessage:"Item has been updated successfully."},cannotUpdateItem:{id:"hr.settings.company.cannot-update-item",defaultMessage:"Unable to update item. Please try again"},header:{id:"hr.app.page.configuration.payroll.employee-loan-policies.header",defaultMessage:"Employee Loan Policies"},description:{id:"hr.app.page.configuration.payroll.employee-loan-policies.description",defaultMessage:"Configure loan policies that employees can apply for"},noItemsYet:{id:"hr.no-items-yet",defaultMessage:"No items yet."},createNewLoanPolicy:{id:"hr.app.page.configuration.add-new",defaultMessage:"Add new"},noPoliciesDescription:{id:"hr.app.page.configuration.payroll.employee-loan-policies.no-policies.description",defaultMessage:"Create and configure loan policies that employees can request for. You can set loan limits, repayment thresholds, add and remove employees from loan policies all in one place."}});export{Mt as E,Ue as L,Ze as a,Ge as b,Pe as c,Re as d,Qe as e,Xe as f,Z as g,ot as u};
