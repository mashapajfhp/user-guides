function g(){return g=Object.assign||function(f){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(f[i]=n[i])}return f},g.apply(this,arguments)}function t(f,e,n,i){i===void 0&&(i=f),delete f.fields[e.name],f.fields[n]=g({},e,{name:n,change:i.fields[n]&&i.fields[n].change,blur:i.fields[n]&&i.fields[n].blur,focus:i.fields[n]&&i.fields[n].focus,lastFieldState:void 0}),f.fields[n].change||delete f.fields[n].change,f.fields[n].blur||delete f.fields[n].blur,f.fields[n].focus||delete f.fields[n].focus}var x=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},O=function(e,n,i){var r=e[0],c=e[1],a=e[2],u=i.changeValue;i.resetFieldState,u(n,r,function(h){var o=[].concat(h||[]);return o.splice(c,0,a),o});var d=g({},n.fields),v=new RegExp("^"+x(r)+"\\[(\\d+)\\](.*)");Object.keys(n.fields).sort().reverse().forEach(function(h){var o=v.exec(h);if(o){var l=Number(o[1]);if(l>=c){var s=r+"["+(l+1)+"]"+o[2];t(n,d[h],s)}}})},P=function(e,n,i){var r=e[0],c=e[1],a=i.changeValue;a(n,r,function(u){return u?[].concat(u,c):c})};function b(f,e,n,i){Object.keys(i.fields).forEach(function(r){if(r.substring(0,e.length)===e){var c=r.substring(e.length),a=f+"["+n+"]"+c;t(i,i.fields[r],a)}})}function j(f,e){Object.keys(f.fields).forEach(function(n){f.fields[n]=g({},f.fields[n],{change:f.fields[n].change||e.fields[n]&&e.fields[n].change,blur:f.fields[n].blur||e.fields[n]&&e.fields[n].blur,focus:f.fields[n].focus||e.fields[n]&&e.fields[n].focus}),f.fields[n].change||delete f.fields[n].change,f.fields[n].blur||delete f.fields[n].blur,f.fields[n].focus||delete f.fields[n].focus})}var w="tmp",R=function(e,n,i){var r=e[0],c=e[1],a=e[2],u=i.changeValue;if(c!==a){u(n,r,function(m){var V=[].concat(m||[]),B=V[c];return V.splice(c,1),V.splice(a,0,B),V});var d=g({},n,{fields:g({},n.fields)}),v=r+"["+c+"]";if(b(r,v,w,n),c<a)for(var h=c+1;h<=a;h++){var o=r+"["+h+"]";b(r,o,""+(h-1),n)}else for(var l=c-1;l>=a;l--){var s=r+"["+l+"]";b(r,s,""+(l+1),n)}var p=r+"["+w+"]";b(r,p,a,n),j(n,d)}},T=function(e,n,i){var r=e[0],c=i.changeValue,a,u;if(c(n,r,function(v){if(v)return v.length?(u=v.length-1,a=v[u],v.slice(0,u)):[]}),u!==void 0){var d=new RegExp("^"+x(r)+"\\["+u+"].*");Object.keys(n.fields).forEach(function(v){d.test(v)&&delete n.fields[v]})}return a},N=function(e,n,i){var r=e[0],c=e[1],a=i.changeValue;a(n,r,function(u){return u?[].concat(u,[c]):[c]})},F=function(e,n,i){var r=e[0],c=e[1],a=i.changeValue,u=i.renameField,d;a(n,r,function(o){var l=[].concat(o||[]);return d=l[c],l.splice(c,1),l});var v=new RegExp("^"+x(r)+"\\[(\\d+)\\](.*)"),h=g({},n,{fields:g({},n.fields)});return Object.keys(n.fields).forEach(function(o){var l=v.exec(o);if(l){var s=Number(l[1]);if(s===c)delete n.fields[o];else if(s>c){delete n.fields[o];var p=r+"["+(s-1)+"]"+l[2];h.fields[p]?t(n,h.fields[o],p,h):u(n,o,p)}}}),d},$=function(e,n){return e.reduce(function(i,r){return r<n?i+1:i},0)},M=function(e,n,i){var r=e[0],c=e[1],a=i.changeValue,u=[].concat(c);u.sort();for(var d=0;d<u.length;d++)d>0&&u[d]===u[d-1]&&u.splice(d--,1);var v=[];a(n,r,function(l){if(v=c.map(function(m){return l&&l[m]}),!l||!u.length)return l;var s=[].concat(l),p=[];return u.forEach(function(m){s.splice(m-p.length,1),p.push(l&&l[m])}),s});var h=new RegExp("^"+x(r)+"\\[(\\d+)\\](.*)"),o=g({},n,{fields:{}});return Object.keys(n.fields).forEach(function(l){var s=h.exec(l);if(s){var p=Number(s[1]);if(!~u.indexOf(p)){var m=r+"["+(p-$(u,p))+"]"+s[2];t(o,n.fields[l],m,n)}}else o.fields[l]=n.fields[l]}),n.fields=o.fields,v},A=function(e,n,i){var r=e[0];return F([r,0],n,i)},E="tmp",q=function(e,n,i){var r=e[0],c=e[1],a=e[2],u=i.changeValue;if(c!==a){u(n,r,function(l){var s=[].concat(l||[]),p=s[c];return s[c]=s[a],s[a]=p,s});var d=g({},n,{fields:g({},n.fields)}),v=r+"["+c+"]",h=r+"["+a+"]",o=r+"["+E+"]";b(r,v,E,n),b(r,h,c,n),b(r,o,a,n),j(n,d)}},z=function(e,n,i){var r=e[0],c=e[1];return O([r,0,c],n,i)},C=function(e,n,i){var r=e[0],c=e[1],a=e[2],u=i.changeValue;u(n,r,function(d){var v=[].concat(d||[]);return v.splice(c,1,a),v})},D={insert:O,concat:P,move:R,pop:T,push:N,remove:F,removeBatch:M,shift:A,swap:q,unshift:z,update:C};export{D as m};
